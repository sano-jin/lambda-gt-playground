<html>
  <head>
    <title>Lambda GT Visualizer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400&display=swap"
      rel="stylesheet"
    />
    <script type="text/javascript" src="../_build/default/js/js.bc.js"></script>

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"
      integrity="sha512-FHsFVKQ/T1KWJDGSbrUhTJyS1ph3eRrxI228ND0EGaEp6v4a/vGwPWd3Dtd/+9cI7ccofZvl/wulICEurHN1pg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script src="https://unpkg.com/@hpcc-js/wasm@0.3.11/dist/index.min.js"></script>
    <script src="https://unpkg.com/d3-graphviz@3.0.5/build/d3-graphviz.js"></script>
    <script type="text/javascript" src="playground.js"></script>

    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div>
      <label for="example-selector">Choose an example:</label>
      <select id="example-selector">
        <option value="map_lltree">Map leaves of a leaf-linked tree</option>
        <option value="append_dlists">Append difference lists</option>
        <option value="pop_back_dlist_empty">
          Pop back an empty difference list
        </option>
        <option value="pop_back_dlist_cons">
          Pop back an difference list and add a cons on head
        </option>
        <option value="pop_back_dlist_many">
          Pop back difference list many times
        </option>
      </select>
    </div>

    <textarea id="editor" name="w3review" rows="4" cols="50">
let f[_X] = {<\x[_X]. {nu _X1. nu _X2. (Succ (_X1, _X), x [_X1])}>(_X)} in

let map[_X] =
  {<\f[_X].{<\x[_L, _R, _X].
  let rec helper[_X] x2[_L, _R, _X] =
    case {Log} {x2[_L, _R, _X]} of
      {nu _L2. nu _R2. nu _X2. nu _X3. (
        y [_L, _R, _X, _L2, _R2, _X2],
        Leaf (_X3, _L2, _R2, _X2),
        z [_X3],
        M (_L2)
      )} ->
        let z2[_X] = {f[_X]} {z[_X]} in
        {helper[_X]}
        {nu _L2. nu _R2. nu _X2. nu _X3. nu _X4. (
          y [_L, _R, _X, _L2, _R2, _X2],
          Leaf (_X3, _L2, _R2, _X2),
          z2 [_X3],
          M (_R2)
        )}
    | otherwise -> case {x2[_L, _R, _X]} of
      { y[_L, _R, _X], M (_R) } -> { y[_L, _R, _X] }
    | otherwise -> {Error, x2[_L, _R, _X]}
  in {helper [_X]} {x[_L, _R, _X], M (_L)}
  >(_X)}>(_X)} in

{map[_X]}
{f [_X]}
({Log}
{
nu _X1. nu _X2. nu _X3. nu _X4. nu _X5. (
  Node (_X1, _X2, _X),
  Leaf (_X4 ,_L, _X3, _X1),
  Zero (_X4),
  Leaf (_X5, _X3, _R, _X2),
  Zero (_X5)
)
})
    </textarea>

    <div id="run-button-wrapper">
      <input type="button" id="start-button" name="start-button" />
      <label for="start-button">start</label>

      <input type="button" id="go-button" name="go-button" />
      <label for="go-button">go</label>
    </div>

    <div id="result"></div>

    <div id="graph" style="text-align: center"></div>
  </body>
</html>
